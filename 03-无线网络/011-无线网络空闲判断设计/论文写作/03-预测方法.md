##### 信道空闲时隙预测问题
###### 问题定义与形式化描述
信道空闲时隙长度预测问题可形式化描述为：给定历史N个信道空闲时隙长度序列 [Li-N-k, Li-1-k]，预测未来的信道空闲时隙长 Li。值得注意的是，本研究选择预测Li 而不是Li-k是基于实际系统实现的考虑。由于预测算法本身需要一定的计算时间，若尝试预测Li-k，则算法必须在Li-1-k结束的瞬间即刻完成计算，这在实际系统中难以保证。通过预测Li，系统可以利用中间k个数据包持续时间进行计算，从而保证预测结果的实时可用性。形式化地，预测问题可表示为寻找函数 f ，使得 Li_hat = f([Li-N-k, Li-1-k])。 其中 Li_hat 表示对 Li的预测值，函数 f 即为本研究要设计的预测模型。为增强预测的时效性，对于间隔k的设定不应该过大。

###### 多峰分布特性分析
在实际无线网络环境中，网络负载呈现出显著的多峰分布特性，这主要源于一天中不同时段的用户活动模式差异。为了验证这一现象，我们分析了多个公开的无线网络数据集，特别是具有代表性的WSS24数据集，该数据集包含了机场和实验室场景的RSSI（接收信号强度指示）测量数据。分析结果表明，RSSI信号强度在不同场景中呈现出显著的分布差异，图XX展示了不同场地和不同信道下RSSI分布统计图的四种典型场景：单峰、双峰、多峰以及不规则分布。
这种网络负载的多峰特性直接影响信道空闲时隙的分布特性。基于此观察，我们提出了双均值混合密度网络（DM-MDN），通过组合多个高斯分布来有效拟合这类多峰数据分布。

##### 双均值混合密度网络(DM-MDN)模型设计
###### 混合密度网络概述
混合密度网络(Mixture Density Network, MDN)是一种能有效建模多峰分布数据的神经网络结构。传统神经网络在回归任务中通常假设目标变量服从单一分布，这在处理多峰数据时显著受限。MDN通过组合多个概率分布来逼近复杂的条件概率密度函数，从而更准确地描述输出变量的不确定性和多模态特性。
MDN的核心在于将神经网络输出转化为定义混合概率分布的参数集，而非直接的预测值。这使网络能够学习输入与输出之间的多对多关系，突破了传统回归模型中多对一关系的局限。
标准MDN的输出包含三组参数：混合系数 π、均值 μ 和标准差 σ。对于包含K个混合成分的MDN，其条件概率密度函数可表示为：
xxxxxxxxxx
![alt text](image.png)
注意要加上每个值的限制
###### 预测任务中的混合密度网络用法
在预测任务中，MDN（混合密度网络）与传统神经网络有显著不同。MDN不直接输出预测值，而是输出定义混合分布的参数集。在实际应用中，常见的做法是先对混合系数 $\pi$ 进行 softmax 处理，以确定最具代表性的分布成分，然后使用该成分的均值作为最终预测值。具体步骤如下：
确定权重最大的高斯成分 $k^* = \arg\max_k \pi_k(x)$；
使用选定成分的均值作为预测值 $\hat{y} = \mathcal{N}(\mu_{k^}(x), \sigma_{k^}^2(x))$。
这种方法本质上是通过隐式分类确定负载状态，再在识别出的负载类型下进行具体预测。例如，在无线网络环境中，不同的混合成分可能对应于不同的网络负载状态（如低负载、中负载、高负载）。模型首先识别最可能的负载状态，然后基于该状态进行预测。
然而，这种预测策略在实际应用中存在一个关键问题：由于高斯分布的特性，预测值的取值范围大概率(约99.7%)为：$(\mu_{k^} - \sigma_{k^}, \mu_{k^} + \sigma_{k^})$。尤其是在采样过程中，可能会产生明显大于均值的预测结果。在无线网络的信道接入场景中，这种“过度乐观”的预测可能导致节点错误认为有足够时间发送数据包，从而增加碰撞风险，最终降低网络性能。
##### 双均值混合密度网络(DM-MDN)模型设计
为解决“过度乐观”这一问题，一种直观的方法是对预测结果应用固定的缩放系数（如0.9），但这种机械的调整缺乏灵活性，无法适应不同网络场景的动态特性。基于此，本研究提出了双均值混合密度网络(DM-MDN)，通过结构化的均值分解机制，实现了在保持预测准确性的同时有效控制预测乐观度的目标。
###### 双均值机制具体设计
DM-MDN的核心创新在于将MDN中的单一均值参数 μk​ 分解为两个相互关联的组件：基础均值 μbase​ 和相对偏移 μoffset,k​。在模型训练阶段，两者共同构成完整的均值表示： XXXXXXXX
这里要再介绍一下 MDN的损失函数
![alt text](image-1.png)

\subsection{3.4.2 双均值机制的数学表达}

DM-MDN的核心创新在于将传统MDN中的单一均值参数$\mu_k$分解为两个相互关联的组件：基准均值$\mu_{\text{base},k}$和相对偏移$\mu_{\text{offset},k}$。在模型训练阶段，两者共同构成整个均值的完整表达式：

\[
\mu_k(x) = \mu_{\text{base},k}(x) + \mu_{\text{offset},k}(x)
\]

为了确保$\mu_{\text{base},k}$和$\mu_{\text{offset},k}$在$\mu_k(x)$中保持合理的比例关系，我们引入了先验均值机制。具体而言，我们设定一个先验参考值$\mu_{\text{prior},k}$：

\[
\mu_{\text{prior},k} = \mu_{\text{base},k} \cdot \frac{1}{(1 - a)} \cdot 10
\]

其中，$a \in (0,1)$为超参数，表示理想情况下$\mu_{\text{base},k}$应占总均值的(1-$a$)*100\%，而$\mu_{\text{offset},k}$贡献剩余的$a$*100\%。在训练过程中，我们通过将$\mu_{\text{offset},k}$与$\mu_{\text{prior},k}$之间的L2正则项加入到损失总损失函数L_{\text{total}}中，引导模型学习这种特定的结构化分解。

完整的损失函数可表示为：

\[
L_{\text{total}} = L_{\text{NLL}} + \lambda \cdot \sum_{k=1}^{K} \|\mu_{\text{offset},k} - \mu_{\text{prior},k}\|_2^2
\]

其中 L_{\text{NLL}} 是混合密度网络主体的损失函数


再介绍一下整体的网络结构图
###### 训练与推理的差异化策略
DM-MDN在训练与推理阶段对于均值的使用存在明显的差异化策略：
训练阶段：使用完整的均值 μbase,k+μoffset,k 拟合真实数据分布，确保模型能够准确捕捉数据的统计特性。
推理阶段：舍弃 μoffset,k部分，仅使用基础均值 μbase,k用于正太分布预测输出，从而实现预测结果的适度保守性。
这种非对称设计巧妙地解决了预测准确性与应用安全性的矛盾。与简单地对预测值应用固定缩放系数不同，虽然超参数a是提前设定好的，但DM-MDN通模型在训练的过程中，既要满足预测的准确度又要满足先验损失，模型会在这两者之间平衡使其能够在已有设定好的超参下细微调整。

##### 预测算法在信道接入中的应用   这里可以写一个算法1
基于DM-MDN的预测结果，节点可以做出更为智能的信道接入决策。具体算法如下：

1. 节点持续监听信道状态，记录历史信道空闲时隙长度。
2. 使用DM-MDN模型预测未来信道空闲时隙长度 Li
3. 
根据实际观测到的信道空闲时隙长度更新历史序列，准备下一轮预测。
这一算法允许节点在预测的信道可用窗口内直接发送数据包，省略了CSMA/CA协议中的间隔帧和二进制指数退避等等待机制，从而提高单个节点的信道接入效率。结合DM-MDN的保守预测特性，该算法在提升信道利用率的同时，有效控制了传输碰撞的风险。

##### 分位数
混合密度网络在网络预测任务中的一个关键优势是其能够捕捉多峰分布特性，并基于当前网络状态提供概率化的预测结果。传统上，预测过程往往简单地采用最大权重的均值和标准差进行一次高斯采样作为最终预测值。然而，采样时所输出的预测值虽然符合当前网络的负载情况，但是采样的输出值是随机的，难以针对不同节点的差异化需求提供定制化的预测服务。为此，本研究提出了基于分位数调整的差异化接入策略，进一步增强了DM-MDN模型在实际应用中的灵活性和适应性。
在概率统计中，分位数代表概率分布中特定百分比位置的值。在高斯分布中，不同分位数对应于距离均值不同标准差倍数的位置。例如，50%分位数对应于分布的均值，而95%分位数则对应于均值加上约1.645倍标准差的位置。
在DM-MDN预测框架中，我们引入分位数参数q∈[0,1]，使得预测系统能够基于选定的高斯成分(k*)，根据指定的分位数生成预测值：
L̂i = μbase,k* + Φ^(-1)(q) · σk*
其中，Φ^(-1)(q)表示标准正态分布的逆累积分布函数在q处的值。这一机制使得预测系统能够在相同网络状态下，根据节点的具体需求，提供从保守到激进的不同预测值。
分位数调整本质上改变了节点对信道空闲时长的预期，从而直接影响其信道接入决策。具体而言：高分位数设置：生成较为乐观的预测值，节点将预期有更长的信道空闲时间可用，使节点的发送策略偏向激进。低分位数设置：生成相对保守的预测值，节点将预期信道空闲时间较短，使节点的发送策略偏向保守。通过调整分位数参数，网络管理者或自适应算法可以为不同节点分配不同的信道接入能力，实现网络资源的差异化分配。
